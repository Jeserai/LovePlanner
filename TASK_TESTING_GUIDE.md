# 📋 任务测试数据使用指南

## 🎯 测试目标

这套测试数据旨在帮你测试Love Planner中各种任务状态的处理功能，包括：
- 任务状态转换逻辑
- 过期任务处理
- 用户交互流程
- UI状态显示

## 📂 文件说明

### 1. `create-task-mock-data.sql` - 创建测试数据
**包含14个测试任务，覆盖所有状态：**

- **recruiting (2个)** - 等待接受的任务
  - 收拾客厅 (Cat发布)
  - 购买生日礼物 (Cat发布)

- **assigned (2个)** - 已接受未开始的任务
  - 准备周末晚餐 (Cat→Cow)
  - 修理台灯 (Cow→Cat)

- **in_progress (2个)** - 正在进行的任务
  - 学习新菜谱 (Cat→Cow)
  - 整理照片 (Cow→Cat)

- **pending_review (2个)** - 等待审核的任务
  - 清洁浴室 (Cat→Cow，已提交)
  - 制作惊喜视频 (Cow→Cat，已提交)

- **completed (2个)** - 已完成的任务
  - 订购鲜花 (Cat→Cow，完成)
  - 购买电影票 (Cow→Cat，完成)

- **abandoned (2个)** - 已放弃的任务
  - 学习吉他 (过期放弃)
  - 组织聚会 (过期放弃)

- **即将过期 (2个)** - 用于测试过期处理
  - 紧急修理水龙头 (1天后到期)
  - 准备重要文件 (2天后到期)

### 2. `test-task-scenarios.sql` - 验证和分析
**用于验证数据质量和分析任务状态：**
- 📊 任务状态分布统计
- 👥 用户任务分布分析
- ⏰ 过期任务检测
- 🔔 即将到期任务提醒
- ✅ 任务流程完整性检查

### 3. `task-operations-test.sql` - 操作测试
**模拟真实的任务状态变更操作：**
- 接受recruiting任务
- 开始执行assigned任务
- 提交in_progress任务
- 审核pending_review任务
- 放弃任务

### 4. `cleanup-test-tasks.sql` - 数据清理
**测试完成后清理数据（可选）**

## 🚀 使用步骤

### 第一步：创建测试数据
```sql
-- 在Supabase SQL编辑器中运行
-- 文件：create-task-mock-data.sql
```

### 第二步：验证数据
```sql
-- 在Supabase SQL编辑器中运行
-- 文件：test-task-scenarios.sql
```

### 第三步：测试应用功能
1. **登录Cat账户**测试：
   - 查看"我发布的任务"
   - 查看"我的任务" 
   - 处理pending_review任务（审核）

2. **登录Cow账户**测试：
   - 查看"可接受的任务"
   - 接受recruiting任务
   - 开始执行assigned任务
   - 提交in_progress任务

3. **UI功能测试**：
   - 任务卡片状态显示
   - 过期任务标识
   - 状态转换按钮
   - 任务详情弹窗

### 第四步：测试状态变更
```sql
-- 在Supabase SQL编辑器中运行
-- 文件：task-operations-test.sql
```

### 第五步：清理数据（可选）
```sql
-- 在Supabase SQL编辑器中运行
-- 文件：cleanup-test-tasks.sql
-- 注意：需要手动取消注释删除命令
```

## 🧪 测试重点

### 1. 状态转换测试
- ✅ recruiting → assigned (接受任务)
- ✅ assigned → in_progress (开始任务)
- ✅ in_progress → pending_review (提交任务)
- ✅ pending_review → completed (审核通过)
- ✅ 任意状态 → abandoned (放弃任务)

### 2. 过期处理测试
- ⏰ 自动标记过期任务为abandoned
- 🔔 即将到期任务提醒
- 📅 过期任务UI显示

### 3. 用户权限测试
- 👤 只能接受别人发布的任务
- 📝 只能审核自己发布的任务
- 🔄 只能操作自己参与的任务

### 4. UI交互测试
- 🎨 不同状态的颜色和图标
- 📱 任务卡片交互
- 🔘 状态转换按钮可用性
- 💬 评论和反馈功能

## 📈 预期结果

测试完成后，你应该能够：
1. ✅ 验证所有任务状态转换正常工作
2. ✅ 确认过期任务处理机制有效
3. ✅ 验证用户权限控制正确
4. ✅ 确保UI状态显示准确
5. ✅ 测试任务交互流程完整

## 🔍 故障排除

如果遇到问题：
1. 检查用户ID是否正确匹配
2. 验证couple关系是否建立
3. 确认数据库表结构完整
4. 检查RLS策略是否正确配置

## 💡 测试建议

1. **分批测试** - 不要一次性测试所有功能
2. **记录问题** - 发现bug及时记录
3. **清理数据** - 测试完成后清理测试数据
4. **重复测试** - 多次测试确保稳定性
